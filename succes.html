<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Succès Steam Familiaux</title>
<link rel="icon" type="image/x-icon" href="icon.ico">
<style>
body { font-family: "Segoe UI", Arial, sans-serif; background-color: #1b2838; color: #fff; margin: 0; padding: 0; text-align: center; }
header { background-color: #171a21; padding: 20px; box-shadow: 0 2px 10px #0007; }
h1 { margin: 0; font-size: 2rem; }
#succesContainer { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; padding: 20px; }
.succes { background: #2a475e; border-radius: 10px; padding: 10px; width: 200px; box-shadow: 0 0 10px #0007; }
.succes img { width: 100%; border-radius: 8px; }
.succes-name { font-weight: bold; margin-top: 8px; color: #66c0f4; }
.succes-desc { font-size: 12px; color: #ccc; }
footer { padding: 20px; font-size: 0.9rem; color: #aaa; }
</style>
</head>
<body>
<header>
  <h1>Succès du jeu</h1>
</header>
<div id="succesContainer">Chargement...</div>
<footer>Fait par apple 3.141592653589793238</footer>

<script>
const proxy = "http://localhost:3000";
const userId = localStorage.getItem("currentUser");
const currentGame = JSON.parse(localStorage.getItem("currentGame") || "{}");
if (!userId || !currentGame.appid) window.location.href = "index.html";

async function loadAchievements() {
  const res = await fetch(`${proxy}/api/achievements?steamid=${userId}&appid=${currentGame.appid}`);
  const data = await res.json();
  const container = document.getElementById("succesContainer");
  container.innerHTML = "";
  
  const list = data.playerstats?.achievements?.filter(a => a.achieved === 1) || [];
  if (list.length === 0) {
    container.textContent = "Aucun succès débloqué pour ce jeu.";
    return;
  }

  list.forEach(s => {
    const div = document.createElement("div");
    div.className = "succes";
    div.innerHTML = `
      <img src="${s.icon}" alt="">
      <div class="succes-name">${s.name}</div>
      <div class="succes-desc">${s.description || "Succès débloqué"}</div>
    `;
    container.appendChild(div);
  });
}

loadAchievements();
</script>
</body>
</html>
